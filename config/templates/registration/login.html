{% extends "base.html" %}
{% load static %}

{% block title %}Ingresar{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{% static 'css/pages/login.css' %}">
{% endblock %}

{% block content %}
<section class="card auth">
  <h1 class="auth__title">Ingreso al panel</h1>

  {% if error_message %}
    <div class="alert alert--error" role="alert">{{ error_message }}</div>
  {% endif %}
  {% if messages %}
    {% for m in messages %}
      <div class="alert" role="status">{{ m }}</div>
    {% endfor %}
  {% endif %}

  <form method="post" class="form" novalidate>
    {% csrf_token %}

    <div class="form-grid">
      <p>
        <label class="label" for="rut">RUT</label>
        <input class="input" type="text" id="rut" name="rut"
               required autocomplete="username" placeholder="12.345.678-5" autofocus>
        <span class="helptext">Formato: 12.345.678-5</span>
      </p>

      <p>
        <label class="label" for="password">Contraseña</label>
        <div class="password">
          <input class="input" type="password" id="password" name="password"
                 required autocomplete="current-password">
          <button class="btn btn--ghost btn--sm password__toggle"
                  type="button" aria-controls="password" aria-pressed="false">
            Mostrar
          </button>
        </div>
      </p>
    </div>

    <div class="actions">
      <button class="btn btn--primary" type="submit">Ingresar</button>
      <a class="btn btn--ghost" href="{% url 'landing_page' %}">Cancelar</a>
    </div>

    <p class="auth__links">
      <a href="{% url 'password_reset' %}">¿Olvidaste tu contraseña?</a>
    </p>
  </form>
</section>
{% endblock %}
{% block page_js %}
<script>
  (function(){
    const btn = document.querySelector('.password__toggle');
    const input = document.getElementById('password');
    if(btn && input){
      btn.addEventListener('click', ()=>{
        const show = input.type === 'password';
        input.type = show ? 'text' : 'password';
        btn.setAttribute('aria-pressed', String(show));
        btn.textContent = show ? 'Ocultar' : 'Mostrar';
      });
    }
  })();
</script>

{% endblock %}
