{% extends "base.html" %}
{% load static %}

{% block title %}Registrar entrada{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{% static 'css/pages/registrar_entrada.css' %}">
{% endblock %}

{% block content %}
<section class="card entrada">
  <header class="entrada__header">
    <h1 class="entrada__title">Registrar entrada de veh√≠culo</h1>
    
    <!-- FOKIN BOTON -->
    <a class="btn btn--siga btn--sm"
   href="{% url 'panel_home' %}">
  Volver
</a>

  </header>

  {% if error %}
    <div class="alert alert--error" role="alert">{{ error }}</div>
  {% endif %}

  {% if not zona_seleccionada %}
    <h2 class="sub">Seleccione una zona de estacionamiento</h2>
    <form method="get" class="form">
      <div class="form-control">
        <label class="label" for="zona">Zona</label>
        <select id="zona" name="zona" class="select" required>
          <option value="">-- Seleccionar zona --</option>
          {% for z in zonas %}
            <option value="{{ z.id }}">{{ z.nombre_zona }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-actions">
        <button type="submit" class="btn btn--primary">Continuar</button>
      </div>
    </form>

  {% else %}
    <!-- PASO 2: Formulario (POST) -->
    <h2 class="sub">Zona seleccionada: {{ zona_seleccionada.nombre_zona }}</h2>

    <form method="post" class="form">
      {% csrf_token %}
      <input type="hidden" name="zona" value="{{ zona_seleccionada.id }}">

      <div class="form-grid">
        <div class="form-control">
          <label class="label" for="patente">Patente</label>
          <input id="patente" name="patente" class="input" required>
        </div>

        <div class="form-control">
          <label class="label" for="nombre_conductor">Nombre del conductor</label>
          <input id="nombre_conductor" name="nombre_conductor" class="input" required>
        </div>

        <div class="form-control">
          <label class="label" for="apellido_conductor">Apellido del conductor</label>
          <input id="apellido_conductor" name="apellido_conductor" class="input">
        </div>

        <div class="form-control">
          <label class="label" for="rut_conductor">RUT del conductor</label>
          <input id="rut_conductor" name="rut_conductor" class="input" placeholder="12345678-9">
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn--primary">Registrar entrada</button>
        <a class="btn btn--siga" href="{% url 'panel_home' %}">Cancelar</a>
      </div>
    </form>

    <p class="volver-zona">
      <a class="btn btn--ghost" href="{% url 'registrar_entrada' %}">Elegir otra zona</a>
    </p>
  {% endif %}
</section>
{% endblock %}
